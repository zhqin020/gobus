<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂÖ¨‰∫§‰ø°ÊÅØÊü•ËØ¢ - ‰∫§‰∫íÂºèÂéüÂûã</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: Midnight Transit -->
    <!-- Application Structure Plan: Êú¨Â∫îÁî®ËÆæËÆ°‰∏∫‰∏Ä‰∏™ÂçïÈ°µÂ∫îÁî®(SPA)ÔºåÈÄöËøáÊéßÂà∂‰∏çÂêåËßÜÂõæ(div)ÁöÑÊòæÁ§∫ÂíåÈöêËóèÊù•Ê®°ÊãüÂéüÁîüÂ∫îÁî®ÁöÑÈ°µÈù¢ÂàáÊç¢ÔºåÊó†ÈúÄÈáçÊñ∞Âä†ËΩΩÈ°µÈù¢„ÄÇ‰∏ªË¶ÅÂåÖÂê´‰∏§‰∏™Ê†∏ÂøÉËßÜÂõæÔºö1) È¶ñÈ°µËßÜÂõæÔºåÊèê‰æõÊ†∏ÂøÉÁöÑÊêúÁ¥¢ÂäüËÉΩÂÖ•Âè£ÂíåÈôÑËøëÁ∫øË∑ØÊ¶ÇËßà„ÄÇ2) Á∫øË∑ØËØ¶ÊÉÖËßÜÂõæÔºåÂú®Áî®Êà∑ÊêúÁ¥¢ÂêéÂ±ïÁ§∫ÔºåÁªìÂêàÊ®°ÊãüÂú∞ÂõæÂíåÂèØÊªöÂä®ÁöÑÁ´ôÁÇπÂàóË°®ÔºåÊèê‰æõÊ≤âÊµ∏ÂºèÁöÑÁ∫øË∑Ø‰ø°ÊÅØÊü•ËØ¢‰ΩìÈ™å„ÄÇËøôÁßçÁªìÊûÑ‰ºòÂÖàËÄÉËôëÁßªÂä®Á´ØÁî®Êà∑ÁöÑÊìç‰ΩúÊµÅÁ®ãÔºå‰ªéÂèëÁé∞Âà∞Êü•ËØ¢‰∏ÄÊ∞îÂëµÊàêÔºåÊèêÂçá‰∫ÜÂèØÁî®ÊÄßÂíåÂìçÂ∫îÈÄüÂ∫¶„ÄÇ -->
    <!-- Visualization & Content Choices: 
        - È¶ñÈ°µ(ÈôÑËøëÁ∫øË∑Ø): ÁõÆÊ†áÊòØÂø´ÈÄüÂëäÁü•„ÄÇ‰ΩøÁî®Âä®ÊÄÅÁîüÊàêÁöÑHTMLÂàóË°®Â±ïÁ§∫ÔºåÊØè‰∏™Êù°ÁõÆÂåÖÂê´Á∫øË∑Ø„ÄÅÊñπÂêëÂíåÈ¢ÑËÆ°Êó∂Èó¥ÔºåÁÆÄÊ¥ÅÊòé‰∫Ü„ÄÇ
        - Á∫øË∑ØËØ¶ÊÉÖ(Âú∞Âõæ): ÁõÆÊ†áÊòØÊèê‰æõÁ©∫Èó¥Ê¶ÇÂøµ„ÄÇ‰ΩøÁî®‰∏Ä‰∏™Â∏¶ÊúâÂä®ÁîªÊïàÊûúÁöÑHTML/CSS divÊù•Ê®°ÊãüÂú∞ÂõæÂíåËΩ¶ËæÜÁöÑÂÆûÊó∂‰ΩçÁΩÆÔºåÈÅøÂÖç‰∫ÜÂä†ËΩΩÂÆåÊï¥Âú∞ÂõæÂ∫ìÁöÑÂ§çÊùÇÊÄßÔºåÂêåÊó∂‰øùÁïô‰∫ÜÊ†∏ÂøÉÁöÑËßÜËßâÂÖÉÁ¥†„ÄÇ
        - Á∫øË∑ØËØ¶ÊÉÖ(Á´ôÁÇπÂàóË°®): ÁõÆÊ†áÊòØÁªÑÁªáÂíåÊØîËæÉ„ÄÇÈááÁî®ÂûÇÁõ¥Êó∂Èó¥Á∫øÂ∏ÉÂ±ÄÔºåÈÄöËøáHTMLÂíåCSSËæπÊ°ÜÂÆûÁé∞ÔºåÊ∏ÖÊô∞Âú∞Â±ïÁ§∫‰∫ÜÁ´ôÁÇπÁöÑÈ°∫Â∫èÂíåÈ¢ÑËÆ°Âà∞ËææÊó∂Èó¥„ÄÇ‰∫§‰∫íÈÄöËøáJSÂÆûÁé∞ÔºåÁî®Êà∑ÂèØÂàáÊç¢ÊñπÂêëÊù•Êõ¥Êñ∞ÂàóË°®„ÄÇ
        - Êï∞ÊçÆ: ÊâÄÊúâÂÖ¨‰∫§Êï∞ÊçÆÔºàÁ∫øË∑Ø„ÄÅÁ´ôÁÇπ„ÄÅÊó∂Èó¥ÔºâÈÉΩÁ°¨ÁºñÁ†ÅÂú®JSÂØπË±°‰∏≠ÔºåÊ®°Êãü‰ªéÂêéÁ´ØAPIËé∑ÂèñÁöÑÊï∞ÊçÆÔºå‰ª•È©±Âä®Êï¥‰∏™Â∫îÁî®ÁöÑÂä®ÊÄÅÂÜÖÂÆπ„ÄÇ
        - ‰∫íÂä®: Ê†∏ÂøÉ‰∫íÂä®ÊòØÊêúÁ¥¢Ê°ÜÂíåÊñπÂêëÂàáÊç¢ÊåâÈíÆ„ÄÇËøô‰∫õÁî±Vanilla JS‰∫ã‰ª∂ÁõëÂê¨Âô®È©±Âä®ÔºåÂä®ÊÄÅÊõ¥Êñ∞DOM‰ª•ÊòæÁ§∫Áõ∏ÂÖ≥‰ø°ÊÅØ„ÄÇ
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .app-container {
            max-width: 420px;
            height: 800px;
            max-height: 90vh;
        }
        .stop-list-container {
            flex-grow: 1;
            overflow-y: auto;
        }
        .stop-item::before {
            content: '';
            position: absolute;
            left: 1rem;
            top: 2.25rem;
            bottom: -0.5rem;
            width: 2px;
            background-color: #4b5563; 
        }
        .stop-item:last-child::before {
            display: none;
        }
        .stop-circle {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            border: 2px solid #4b5563;
        }
         .stop-circle.active {
            background-color: #3b82f6;
            border-color: #3b82f6;
        }
        .bus-on-map {
            animation: moveBus 10s linear infinite;
        }
        @keyframes moveBus {
            0% { left: 10%; }
            50% { left: 80%; }
            100% { left: 10%; }
        }
    </style>
</head>
<body class="bg-gray-900 flex items-center justify-center min-h-screen p-4">

    <div id="app" class="app-container bg-[#181a1d] rounded-3xl shadow-2xl flex flex-col overflow-hidden w-full">

        <!-- Home Screen -->
        <div id="home-screen" class="flex flex-col h-full">
            <header class="p-4 pt-6 text-white">
                <div class="w-full h-32 bg-gray-700 rounded-xl flex items-center justify-center text-gray-500 mb-4 bg-cover bg-center" style="background-image: url('https://placehold.co/400x150/334155/e2e8f0?text=Map+Preview');">
                    <div class="text-center">
                        <span class="text-3xl">üìç</span>
                        <p class="font-semibold">ÂàóÊ≤ªÊñá, BC</p>
                    </div>
                </div>
                <div class="relative">
                    <input id="search-input" type="text" placeholder="ÊêúÁ¥¢Á∫øË∑ØÊàñÁ´ôÁÇπ..." class="w-full bg-[#2c2f33] text-white placeholder-gray-400 rounded-lg py-3 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">üîç</span>
                </div>
            </header>
            
            <div id="nearby-section" class="flex-grow p-4 overflow-y-auto">
                <h2 class="text-lg font-bold text-white mb-3">ÈôÑËøëÁ∫øË∑Ø</h2>
                <div id="nearby-list" class="space-y-4">
                    <!-- Nearby routes will be injected here by JS -->
                </div>
            </div>
            
             <footer class="p-4 border-t border-gray-700 text-center">
                <p class="text-xs text-gray-500">Êï∞ÊçÆÊù•Ê∫ê: TransLink (‰ªÖ‰æõÊºîÁ§∫)</p>
            </footer>
        </div>

        <!-- Route Details Screen -->
        <div id="route-details-screen" class="hidden flex-col h-full">
            <!-- Header -->
            <header class="flex items-center justify-between p-4 bg-[#1f2124] text-white flex-shrink-0">
                <button id="back-button" class="text-2xl font-bold">&larr;</button>
                <div class="text-center">
                    <h1 id="route-number-display" class="text-2xl font-bold"></h1>
                    <p id="route-name-display" class="text-sm text-gray-400"></p>
                </div>
                <div class="w-8"></div>
            </header>

            <!-- Map View -->
            <div class="w-full h-40 bg-gray-800 flex-shrink-0 relative overflow-hidden p-4">
                 <div class="absolute top-1/2 left-0 w-full h-1 bg-blue-500/50"></div>
                 <div class="bus-on-map absolute top-1/2 -translate-y-1/2 text-2xl">üöå</div>
                 <div class="absolute bottom-2 left-4 bg-black/50 text-white text-xs p-2 rounded-lg">
                     <p>‚ö†Ô∏è Ê®°ÊãüÊúçÂä°Ë≠¶Êä•ÔºöÊ≠§Á∫øË∑ØÂèØËÉΩÂ≠òÂú®Âª∂ËØØ„ÄÇ</p>
                 </div>
            </div>
            
            <!-- Direction Toggle -->
            <div id="direction-toggle" class="flex justify-around p-2 bg-[#1f2124] flex-shrink-0">
                <!-- Direction buttons will be injected here -->
            </div>

            <!-- Stops List -->
            <div class="stop-list-container p-4">
                <div id="stops-list" class="relative">
                    <!-- Stops will be injected here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- DATA ---
            const transitData = {
                "410": {
                    routeName: "22nd St Station / Brighouse Station",
                    directions: [
                        {
                            directionName: "ÂºÄÂæÄ 22nd St Station",
                            stops: [
                                { name: "Brighouse Station", time: 2, transfers: ["Canada Line"] },
                                { name: "No. 3 Rd / Cook Rd", time: 5, transfers: [] },
                                { name: "Garden City Rd / Bennett Rd", time: 9, transfers: ["408"] },
                                { name: "Cambie Rd / Shell Rd", time: 14, transfers: [] },
                                { name: "Knight St / Bridgeport Rd", time: 20, transfers: ["N10"] },
                                { name: "Hamilton Rd / Westminster Hwy", time: 25, transfers: [] },
                                { name: "22nd St Station", time: 30, transfers: ["Expo Line", "100", "129"] },
                            ]
                        },
                        {
                            directionName: "ÂºÄÂæÄ Brighouse Station",
                            stops: [
                                { name: "22nd St Station", time: 3, transfers: ["Expo Line", "100", "129"] },
                                { name: "Hamilton Rd / Westminster Hwy", time: 8, transfers: [] },
                                { name: "Knight St / Bridgeport Rd", time: 13, transfers: ["N10"] },
                                { name: "Cambie Rd / Shell Rd", time: 18, transfers: [] },
                                { name: "Garden City Rd / Bennett Rd", time: 23, transfers: ["408"] },
                                { name: "No. 3 Rd / Cook Rd", time: 27, transfers: [] },
                                { name: "Brighouse Station", time: 30, transfers: ["Canada Line"] },
                            ]
                        }
                    ]
                },
                "404": {
                    routeName: "Four Road / Richmond-Brighouse Station",
                    directions: [
                        {
                            directionName: "ÂºÄÂæÄ Four Road",
                            stops: [
                                { name: "Richmond-Brighouse Stn", time: 41, transfers: ["Canada Line"] },
                                { name: "Granville Ave / Buswell St", time: 44, transfers: [] },
                                { name: "Blundell Rd / Gilbert Rd", time: 48, transfers: ["402"] },
                                { name: "Steveston Hwy / No. 4 Rd", time: 52, transfers: [] },
                            ]
                        }
                    ]
                },
                 "408": {
                    routeName: "Riverport / Brighouse Station",
                    directions: [
                        {
                            directionName: "ÂºÄÂæÄ Riverport",
                            stops: [
                                { name: "Brighouse Station", time: 7, transfers: ["Canada Line"] },
                                { name: "Garden City Rd / Bennett Rd", time: 11, transfers: ["410"] },
                                { name: "Bridgeport Rd / Sweden Way", time: 15, transfers: ["407"] },
                                { name: "Entertainment Blvd / Riverport", time: 20, transfers: [] },
                            ]
                        },
                        {
                            directionName: "ÂºÄÂæÄ Ironwood",
                            stops: [
                                { name: "Brighouse Station", time: "23:50", transfers: ["Canada Line"] },
                                { name: "Garden City Rd / Bennett Rd", time: "23:54", transfers: ["410"] },
                                { name: "Steveston Hwy / No. 5 Rd", time: "00:05", transfers: [] },
                                { name: "Ironwood", time: "00:10", transfers: [] },
                            ]
                        }
                    ]
                }
            };

            // --- DOM ELEMENTS ---
            const homeScreen = document.getElementById('home-screen');
            const routeDetailsScreen = document.getElementById('route-details-screen');
            const searchInput = document.getElementById('search-input');
            const backButton = document.getElementById('back-button');
            const nearbyList = document.getElementById('nearby-list');
            const routeNumberDisplay = document.getElementById('route-number-display');
            const routeNameDisplay = document.getElementById('route-name-display');
            const directionToggle = document.getElementById('direction-toggle');
            const stopsList = document.getElementById('stops-list');

            let activeDirectionIndex = 0;
            let currentRouteId = null;

            // --- RENDER FUNCTIONS ---
            function renderNearbyRoutes() {
                nearbyList.innerHTML = '';
                const nearbyRoutes = [
                    { id: '404', direction: 'Four Road', time: 41, unit: 'ÂàÜÈíü' },
                    { id: '408', direction: 'Riverport', time: 7, unit: 'ÂàÜÈíü' },
                    { id: '408', direction: 'Ironwood', time: '23:50', unit: ''},
                    { id: '410', direction: '22nd St Station', time: 15, unit: 'ÂàÜÈíü'}
                ];

                nearbyRoutes.forEach(route => {
                    const routeCard = `
                        <div class="bg-[#2c2f33] p-4 rounded-lg flex items-center space-x-4 cursor-pointer hover:bg-gray-700 transition-colors" data-route-id="${route.id}">
                            <div class="text-3xl font-bold text-blue-400 w-16 text-center">${route.id}</div>
                            <div class="flex-grow">
                                <div class="text-white font-semibold">‚Üí ${route.direction}</div>
                                <div class="text-sm text-gray-400">${transitData[route.id].routeName}</div>
                            </div>
                            <div class="text-right">
                                <div class="text-2xl font-bold text-white">${route.time}</div>
                                <div class="text-sm text-gray-400">${route.unit}</div>
                            </div>
                        </div>
                    `;
                    nearbyList.insertAdjacentHTML('beforeend', routeCard);
                });
            }

            function renderRouteDetails(routeId, directionIndex) {
                const route = transitData[routeId];
                if (!route) return;

                currentRouteId = routeId;
                activeDirectionIndex = directionIndex;

                routeNumberDisplay.textContent = routeId;
                routeNameDisplay.textContent = route.routeName;

                directionToggle.innerHTML = '';
                route.directions.forEach((dir, index) => {
                    const buttonClasses = index === activeDirectionIndex
                        ? 'bg-blue-600 text-white'
                        : 'bg-gray-600 text-gray-300';
                    const button = `
                        <button class="flex-1 py-2 px-4 text-sm font-semibold rounded-md transition-colors ${buttonClasses}" data-direction-index="${index}">
                            ${dir.directionName}
                        </button>
                    `;
                    directionToggle.insertAdjacentHTML('beforeend', button);
                });

                stopsList.innerHTML = '';
                route.directions[directionIndex].stops.forEach((stop, index) => {
                    const isActive = index === 0;
                    const transferBadges = stop.transfers.map(t => `<span class="bg-gray-600 text-xs py-0.5 px-1.5 rounded">${t}</span>`).join(' ');
                    
                    const stopItem = `
                        <div class="stop-item relative flex items-start space-x-4 pb-6">
                            <div class="mt-1.5 flex-shrink-0">
                                <div class="stop-circle ${isActive ? 'active' : ''}"></div>
                            </div>
                            <div class="flex-grow">
                                <p class="text-white font-semibold">${stop.name}</p>
                                <div class="text-sm text-gray-400 mt-1 flex flex-wrap gap-1">
                                    ${transferBadges}
                                </div>
                            </div>
                            <div class="text-right text-white font-semibold">
                                ${typeof stop.time === 'number' ? `+${stop.time}ÂàÜÈíü` : stop.time}
                            </div>
                        </div>
                    `;
                    stopsList.insertAdjacentHTML('beforeend', stopItem);
                });
            }

            // --- EVENT LISTENERS ---
            searchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    const routeId = searchInput.value.trim();
                    if (transitData[routeId]) {
                        renderRouteDetails(routeId, 0);
                        homeScreen.classList.add('hidden');
                        routeDetailsScreen.classList.remove('hidden');
                        routeDetailsScreen.classList.add('flex');
                    } else {
                        alert(`Êú™ÊâæÂà∞Á∫øË∑Ø "${routeId}"„ÄÇËØ∑Â∞ùËØï 410, 404, Êàñ 408„ÄÇ`);
                    }
                    searchInput.value = '';
                }
            });

            backButton.addEventListener('click', function() {
                routeDetailsScreen.classList.add('hidden');
                routeDetailsScreen.classList.remove('flex');
                homeScreen.classList.remove('hidden');
                homeScreen.classList.add('flex');
            });
            
            nearbyList.addEventListener('click', function(e) {
                const card = e.target.closest('[data-route-id]');
                if (card) {
                    const routeId = card.dataset.routeId;
                    renderRouteDetails(routeId, 0);
                    homeScreen.classList.add('hidden');
                    routeDetailsScreen.classList.remove('hidden');
                    routeDetailsScreen.classList.add('flex');
                }
            });

            directionToggle.addEventListener('click', function(e) {
                const button = e.target.closest('[data-direction-index]');
                if (button) {
                    const directionIndex = parseInt(button.dataset.directionIndex, 10);
                    renderRouteDetails(currentRouteId, directionIndex);
                }
            });

            // --- INITIALIZATION ---
            renderNearbyRoutes();
        });
    </script>

</body>
</html>
